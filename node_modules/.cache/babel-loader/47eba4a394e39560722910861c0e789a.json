{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/i818433/Desktop/TTB2020/src/components/Prediction.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { useForm } from \"react-hook-form\";\nimport Rain from \"./img/rain.svg\";\nimport Risk from \"./img/risk.svg\";\nimport Temp from \"./img/temp.svg\";\nimport windSpeed from \"./img/wind-speed.svg\";\n\nconst axios = require('axios');\n\nconst MONTH_INDEX = 6;\nconst DATA_UNAVAILABLE = \"Sorry! Not enough data available.\";\nconst KELVIN_MULT = 9 / 5;\nconst KELVIN_CONST = -459.67;\nconst RISK = {\n  NODATA: \"Sorry, we don't have enough data to make predictions today.\",\n  NONE: \"Yay, no risk of fire!\",\n  LITTLE: \"It is unlikely that there is a fire in your area, but beware of higher temperatures, stronger winds, and drier conditions.\",\n  MEDIUM: \"Beware of potential fires in your area! Stay up to date with local forecasts for further info.\",\n  HIGH: \"There is very likely a fire in your area! Please read our Community section for help in preparing.\"\n};\nexport const Prediction = () => {\n  _s();\n\n  const [weather, setWeather] = useState({});\n  const [history, setHistory] = useState({});\n  const [riskLevel, setLevel] = useState(\"\");\n  const [prediction, setPrediction] = useState(false);\n  const {\n    register,\n    handleSubmit\n  } = useForm();\n\n  const fetchPrediction = () => {\n    let riskFactor = 0;\n    let numValid = 0;\n    ;\n\n    if (history[\"temp\"] !== DATA_UNAVAILABLE) {\n      numValid++;\n      if (weather[\"temp\"] >= history[\"temp\"] - 10) riskFactor++;\n    }\n\n    if (history[\"prcp\"] !== DATA_UNAVAILABLE) {\n      numValid++;\n      if (weather[\"prcp\"] <= history[\"prcp\"] + 2) riskFactor++;\n    }\n\n    if (history[\"wind\"] !== DATA_UNAVAILABLE) {\n      numValid++;\n      if (weather[\"wind\"] >= history[\"wind\"] - 1) riskFactor++;\n    }\n\n    if (numValid == 0) setLevel(RISK.NODATA);else if (riskFactor == 3) setLevel(RISK.HIGH);else if (riskFactor == 2) setLevel(RISK.MEDIUM);else if (riskFactor == 1) setLevel(RISK.LITTLE);else if (riskFactor == 0) setLevel(RISK.NONE);\n    console.log(riskLevel);\n  };\n\n  const onSubmit = data => {\n    const lat = data.latitude;\n    const lon = data.longitude;\n    const apikey = '4442842ee5abc16c9caa8989d5335c42';\n    const owmUrl = 'http://api.openweathermap.org/data/2.5/weather?lat=' + lat + '&lon=' + lon + '&appid=' + apikey;\n    axios.get(owmUrl).then(res => {\n      const weatherData = res.data;\n      const currWeather = {\n        \"temp\": 0,\n        \"wind\": 0,\n        \"type\": \"\"\n      };\n      currWeather[\"temp\"] = (KELVIN_MULT * weatherData.main.temp + KELVIN_CONST).toFixed(2);\n      currWeather[\"wind\"] = weatherData.wind.speed;\n      currWeather[\"type\"] = weatherData.weather[0].main;\n      setWeather(currWeather);\n    });\n    const historyUrl = 'http://localhost:3001/weather_month?LATITUDE=' + lat + '&LONGITUDE=' + lon;\n    console.log(historyUrl);\n    axios.get(historyUrl).then(res => {\n      let maxTemp = 0,\n          prcp = 0,\n          wind = 0;\n      let numTemp = 0,\n          numPrcp = 0,\n          numWind = 0;\n      let avgTemp = -1,\n          avgPrcp = -1,\n          avgWind = -1;\n      res.data.forEach(entry => {\n        const month = entry[\"DATE\"].charAt(MONTH_INDEX);\n\n        if (month >= 6 && month <= 9) {\n          if (entry[\"EMXT\"] !== \"\") {\n            maxTemp += entry[\"EMXT\"];\n            numTemp++;\n          }\n\n          if (entry[\"PRCP\"] !== \"\") {\n            prcp += entry[\"PRCP\"];\n            numPrcp++;\n          }\n\n          if (entry[\"WSF2\"] !== \"\") {\n            wind += entry[\"WSF2\"];\n            numWind++;\n          }\n        }\n      });\n      if (numTemp > 1) avgTemp = maxTemp / numTemp;else avgTemp = DATA_UNAVAILABLE;\n      if (numPrcp > 1) avgPrcp = prcp / numPrcp;else avgPrcp = DATA_UNAVAILABLE;\n      if (wind > 1) avgWind = wind / numWind;else avgWind = DATA_UNAVAILABLE;\n      setHistory({\n        \"temp\": avgTemp,\n        \"prcp\": avgPrcp,\n        \"wind\": avgWind\n      });\n      setPrediction(true);\n    });\n    fetchPrediction();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"prediction\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"h3\", {\n        id: \"enter-coords\",\n        children: \"Enter your coordinates! \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 18\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      id: \"form\",\n      onSubmit: handleSubmit(onSubmit),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"input\",\n          name: \"latitude\",\n          placeholder: \"Your Latitude\",\n          ref: register,\n          style: {\n            height: \"2em\",\n            width: \"16em\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"input\",\n          name: \"longitude\",\n          placeholder: \"Your Longitude\",\n          ref: register,\n          style: {\n            height: \"2em\",\n            width: \"16em\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"submit\",\n          type: \"submit\",\n          placeholder: \"Enter\",\n          value: \"Enter\",\n          style: {\n            height: \"2.5em\",\n            width: \"8em\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }, this), prediction && /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"boxes\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"status-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: Risk,\n          className: \"risk-icon\",\n          alt: \"risk icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Risk level: \", riskLevel]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"temperature-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: Temp,\n          className: \"temp-icon\",\n          alt: \"temp icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Current Temp: \", weather[\"temp\"]]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Average Max Temp: \", history[\"temp\"]]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"wind-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: windSpeed,\n          className: \"wind-icon\",\n          alt: \"wind icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Wind speed: \", weather[\"wind\"]]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Avg wind: \", history[\"wind\"]]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"rain-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: Rain,\n          className: \"rain-icon\",\n          alt: \"rain icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Weather type: \", weather[\"type\"]]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Avg precipitation: \", history[\"prcp\"]]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Prediction, \"aK7Ra5eF30pE7v7psTFkDyQOEEQ=\", false, function () {\n  return [useForm];\n});\n\n_c = Prediction;\n\nvar _c;\n\n$RefreshReg$(_c, \"Prediction\");","map":{"version":3,"sources":["/Users/i818433/Desktop/TTB2020/src/components/Prediction.js"],"names":["React","useState","useForm","axios","require","MONTH_INDEX","DATA_UNAVAILABLE","KELVIN_MULT","KELVIN_CONST","RISK","NODATA","NONE","LITTLE","MEDIUM","HIGH","Prediction","weather","setWeather","history","setHistory","riskLevel","setLevel","prediction","setPrediction","register","handleSubmit","fetchPrediction","riskFactor","numValid","console","log","onSubmit","data","lat","latitude","lon","longitude","apikey","owmUrl","get","then","res","weatherData","currWeather","main","temp","toFixed","wind","speed","historyUrl","maxTemp","prcp","numTemp","numPrcp","numWind","avgTemp","avgPrcp","avgWind","forEach","entry","month","charAt","height","width","Risk","Temp","windSpeed","Rain"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\nimport { useForm } from \"react-hook-form\";\nimport Rain from './img/rain.svg';\nimport Risk from './img/risk.svg';\nimport Temp from './img/temp.svg';\nimport windSpeed from './img/wind-speed.svg';\n\nconst axios = require('axios');\n\nconst MONTH_INDEX = 6;\nconst DATA_UNAVAILABLE = \"Sorry! Not enough data available.\";\nconst KELVIN_MULT = 9/5;\nconst KELVIN_CONST = -459.67;\nconst RISK = {\n    NODATA: \"Sorry, we don't have enough data to make predictions today.\",\n    NONE: \"Yay, no risk of fire!\",\n    LITTLE: \"It is unlikely that there is a fire in your area, but beware of higher temperatures, stronger winds, and drier conditions.\",\n    MEDIUM: \"Beware of potential fires in your area! Stay up to date with local forecasts for further info.\",\n    HIGH: \"There is very likely a fire in your area! Please read our Community section for help in preparing.\"\n}\n\nexport const Prediction = () => {\n    const [weather,setWeather]=useState({});\n    const [history, setHistory]=useState({});\n    const [riskLevel, setLevel] = useState(\"\");\n    const [prediction,setPrediction]=useState(false);\n    const {register, handleSubmit} = useForm();\n\n    const fetchPrediction = () => {\n        let riskFactor = 0;\n        let numValid = 0;;\n        if(history[\"temp\"] !== DATA_UNAVAILABLE) {\n            numValid++;\n            if(weather[\"temp\"] >= history[\"temp\"] - 10) \n                riskFactor++;\n        }\n        if(history[\"prcp\"] !== DATA_UNAVAILABLE) {\n            numValid++;\n            if(weather[\"prcp\"] <= history[\"prcp\"] + 2) \n                riskFactor++;\n        }\n        if(history[\"wind\"] !== DATA_UNAVAILABLE) {\n            numValid++;\n            if(weather[\"wind\"] >= history[\"wind\"] - 1) \n                riskFactor++;\n        }\n        if(numValid == 0) setLevel(RISK.NODATA);\n        else if(riskFactor == 3) setLevel(RISK.HIGH);\n        else if(riskFactor == 2) setLevel(RISK.MEDIUM);\n        else if(riskFactor == 1) setLevel(RISK.LITTLE);\n        else if(riskFactor == 0) setLevel(RISK.NONE);\n        console.log(riskLevel);\n\n    }\n\n    const onSubmit = data => { \n        const lat = data.latitude;\n        const lon = data.longitude;\n        const apikey = '4442842ee5abc16c9caa8989d5335c42';\n        const owmUrl = 'http://api.openweathermap.org/data/2.5/weather?lat='+lat+'&lon='+lon+'&appid='+apikey;                     \n        axios.get(owmUrl)\n        .then(res => {\n            const weatherData = res.data;\n            const currWeather = {\n                \"temp\": 0,\n                \"wind\": 0,\n                \"type\": \"\"\n            }\n            currWeather[\"temp\"] = (KELVIN_MULT*weatherData.main.temp+KELVIN_CONST).toFixed(2);\n            currWeather[\"wind\"] = weatherData.wind.speed;\n            currWeather[\"type\"] = weatherData.weather[0].main;\n            setWeather(currWeather);\n        });\n        const historyUrl = 'http://localhost:3001/weather_month?LATITUDE='+lat+'&LONGITUDE='+lon;\n        console.log(historyUrl);\n        axios.get(historyUrl)\n        .then(res => {\n            let maxTemp = 0, prcp = 0, wind = 0;\n            let numTemp = 0, numPrcp = 0, numWind = 0;\n            let avgTemp = -1, avgPrcp = -1, avgWind = -1;\n            res.data.forEach(entry => {\n                const month = entry[\"DATE\"].charAt(MONTH_INDEX);\n                if(month >= 6 && month <= 9) {\n                    if(entry[\"EMXT\"] !== (\"\")) {\n                        maxTemp += entry[\"EMXT\"];\n                        numTemp++;\n                    }\n                    if(entry[\"PRCP\"] !== (\"\")) {\n                        prcp += entry[\"PRCP\"];\n                        numPrcp++;\n                    }\n                    if(entry[\"WSF2\"] !== (\"\")) {\n                        wind += entry[\"WSF2\"];\n                        numWind++;\n                    }\n                }\n            });\n            if(numTemp > 1) avgTemp = maxTemp/numTemp;\n            else avgTemp = DATA_UNAVAILABLE;\n            if(numPrcp > 1) avgPrcp = prcp/numPrcp;\n            else avgPrcp = DATA_UNAVAILABLE;\n            if(wind > 1) avgWind = wind/numWind;\n            else avgWind = DATA_UNAVAILABLE;\n            setHistory({\n                \"temp\": avgTemp, \n                \"prcp\": avgPrcp, \n                \"wind\": avgWind}\n            );\n            setPrediction(true);\n        });\n        fetchPrediction();\n    };\n\n    return (\n        <div id=\"prediction\">  \n            <div><h3 id=\"enter-coords\">Enter your coordinates! </h3></div>\n            <form id=\"form\" onSubmit={handleSubmit(onSubmit)}>\n                <div>\n                    <input id=\"input\" name=\"latitude\" placeholder=\"Your Latitude\" ref={register} \n                        style={{height:\"2em\", width: \"16em\"}}/>\n                    <input id=\"input\" name=\"longitude\" placeholder=\"Your Longitude\" ref={register} \n                        style={{height:\"2em\", width: \"16em\"}}/>\n                    <input id=\"submit\" type=\"submit\" placeholder=\"Enter\" value = \"Enter\" \n                        style={{height:\"2.5em\", width: \"8em\"}}/>\n                </div>\n            </form>\n            {prediction && (\n                <div id = \"boxes\">\n                    <div id = \"status-box\">\n                        <img src={Risk} className=\"risk-icon\" alt=\"risk icon\"/>\n                        <p>Risk level: {riskLevel}</p>\n                    </div>\n                    <div id = \"temperature-box\">\n                        <img src={Temp} className=\"temp-icon\" alt=\"temp icon\"/>\n                        <p>Current Temp: {weather[\"temp\"]}</p>\n                        <p>Average Max Temp: {history[\"temp\"]}</p>\n                    </div>\n                    <div id = \"wind-box\">\n                        <img src={windSpeed} className=\"wind-icon\" alt=\"wind icon\"/>\n                        <p>Wind speed: {weather[\"wind\"]}</p>\n                        <p>Avg wind: {history[\"wind\"]}</p>\n                    </div>\n                    <div id = \"rain-box\">\n                        <img src={Rain} className=\"rain-icon\" alt=\"rain icon\"/>\n                        <p>Weather type: {weather[\"type\"]}</p>\n                        <p>Avg precipitation: {history[\"prcp\"]}</p>\n                    </div>\n                </div>\n            )\n            }\n        </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}